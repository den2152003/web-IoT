extends ../../../layout/default.pug
include ../../../mixin/alert.pug

block main
  .create-wrapper
    .container
      .row.justify-content-center
        .col-lg-6.col-md-10
          +alert-success(5000)
          +alert-error(5000)
          a(href=`javascript:history.back()` class="btn-back mb-4")
            i.fas.fa-arrow-left.mr-2
            | Quay láº¡i danh sÃ¡ch quáº£n lÃ½

          .modern-card
            .card-header-gradient
              i.fas.fa-plus-circle.fa-2x.mb-3
              h2.font-weight-bold.mb-0 Thiáº¿t láº­p Ä‘iá»u kiá»‡n má»›i
              p.opacity-75.small.mt-2 Tá»± Ä‘á»™ng hÃ³a thiáº¿t bá»‹ dá»±a trÃªn ngÆ°á»¡ng cáº£m biáº¿n

            .form-body
              form(
                action=`/node/sensor/create/${gatewayId}/${nodeId}`
                id="form-create-condition"
                method="POST"
              )
                input(type="hidden" name="gatewayId" value=gatewayId)
                input(type="hidden" name="nodeId" value=nodeId)

                //- ThÃ´ng tin Node hiá»ƒn thá»‹ (Read-only)
                .row.mb-4
                  .col-6
                    small.text-muted.d-block Gateway ID
                    span.font-weight-bold.text-dark #{gatewayId}
                  .col-6
                    small.text-muted.d-block Node ID
                    span.font-weight-bold.text-dark #{nodeId}

                hr.my-4.opacity-5

                //- Loáº¡i cáº£m biáº¿n
                .form-group-custom
                  label(for="sensorType") 
                    i.fas.fa-thermometer-half
                    | Loáº¡i cáº£m biáº¿n
                  select.form-control-modern(name="sensorType" id="sensorType" required)
                    option(value="" disabled selected) Chá»n loáº¡i cáº£m biáº¿n cáº§n theo dÃµi
                    option(value="temperature") ðŸ”¥ Nhiá»‡t Ä‘á»™ (Â°C)
                    option(value="humidity") ðŸ’§ Äá»™ áº©m (%)
                    option(value="light") â˜€ï¸ Ãnh sÃ¡ng (Lux)
                    option(value="air") ðŸŒ¬ï¸ Cháº¥t lÆ°á»£ng khÃ´ng khÃ­

                //- GiÃ¡ trá»‹ tá»‘i thiá»ƒu & tá»‘i Ä‘a (Náº±m trÃªn 1 hÃ ng)
                .range-input-group
                  .form-group-custom
                    label(for="minValue") 
                      i.fas.fa-arrow-down
                      | NgÆ°á»¡ng dÆ°á»›i
                    input.form-control-modern(type="number" id="minValue" name="minValue" placeholder="0" required)
                  
                  .form-group-custom
                    label(for="maxValue") 
                      i.fas.fa-arrow-up
                      | NgÆ°á»¡ng trÃªn
                    input.form-control-modern(type="number" id="maxValue" name="maxValue" placeholder="100" required)

                //- Thiáº¿t bá»‹ cháº¥p hÃ nh
                .form-group-custom
                  label(for="device") 
                    i.fas.fa-plug
                    | Thiáº¿t bá»‹ Ä‘iá»u khiá»ƒn
                  select.form-control-modern(id="device" name="deviceId" required)
                    option(value="" disabled selected) Chá»n thiáº¿t bá»‹ thá»±c thi lá»‡nh
                    each item in device
                      option(value=item._id) #{item.deviceName}

                //- Tráº¡ng thÃ¡i pháº£n há»“i
                .form-group-custom
                  label(for="status") 
                    i.fas.fa-toggle-on
                    | HÃ nh Ä‘á»™ng khi thá»a Ä‘iá»u kiá»‡n
                  select.form-control-modern(id="status" name="status" required)
                    option(value="" disabled selected) Chá»n hÃ nh Ä‘á»™ng
                    option(value="turnOn") âœ… Báº­t thiáº¿t bá»‹
                    option(value="turnOff") âŒ Táº¯t thiáº¿t bá»‹

                button.btn-submit.mt-4(type="submit")
                  span XÃ¡c nháº­n táº¡o Ä‘iá»u kiá»‡n
                  i.fas.fa-chevron-right.ml-2


    
    style. 
        :root {
        --primary-gradient: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
        --glass-bg: rgba(255, 255, 255, 0.9);
        }

        .create-wrapper {
            background: #f1f5f9;
            min-height: 100vh;
            padding: 40px 0;
        }

        .modern-card {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 20px 40px rgba(0,0,0,0.05);
            overflow: hidden;
        }

        .card-header-gradient {
            background: var(--primary-gradient);
            padding: 30px;
            color: white;
            text-align: center;
        }

        .form-body {
        padding: 40px;
        }

        .form-group-custom {
        margin-bottom: 25px;
        }

        .form-group-custom label {
        font-weight: 600;
        color: #475569;
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        font-size: 0.9rem;
        }

        .form-group-custom label i {
        margin-right: 8px;
        color: #6366f1;
        }

        .form-control-modern {
        width: 100%;
        padding: 12px 18px;
        border-radius: 14px;
        border: 2px solid #e2e8f0;
        background: #f8fafc;
        transition: all 0.3s ease;
        }

        .form-control-modern:focus {
        border-color: #6366f1;
        background: #fff;
        outline: none;
        box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
        }

        .btn-submit {
        width: 100%;
        padding: 15px;
        border-radius: 14px;
        background: var(--primary-gradient);
        color: white;
        border: none;
        font-weight: 700;
        font-size: 1rem;
        box-shadow: 0 10px 20px rgba(99, 102, 241, 0.2);
        transition: all 0.3s ease;
        }

        .btn-submit:hover {
        transform: translateY(-2px);
        box-shadow: 0 15px 25px rgba(99, 102, 241, 0.3);
        }

        .range-input-group {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        }

        /* NÃºt Quay Láº¡i */
        .btn-back {
        display: inline-flex;
        align-items: center;
        color: #636e72;
        font-weight: 500;
        text-decoration: none;
        transition: 0.3s;
        }
        .btn-back:hover {
            color: var(--primary-color);
            transform: translateX(-5px);
        }

    script.
        document.getElementById('form-create-condition').addEventListener('submit', function(e) {
            const min = parseFloat(document.getElementById('minValue').value);
            const max = parseFloat(document.getElementById('maxValue').value);

            if (min >= max) {
                e.preventDefault(); // Cháº·n Ä‘á»©ng viá»‡c gá»­i form
                alert('Lá»—i: NgÆ°á»¡ng dÆ°á»›i (' + min + ') khÃ´ng Ä‘Æ°á»£c lá»›n hÆ¡n ngÆ°á»¡ng trÃªn (' + max + ')!');
            }
        });